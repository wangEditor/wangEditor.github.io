<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.41">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?a25f260386e515f4eee3e0a6bb4166be";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
            </script><title>自定义扩展新功能 | wangEditor</title><meta name="description" content="开源 Web 富文本编辑器，开箱即用，配置简单">
    <link rel="modulepreload" href="/assets/app.62bc27ba.js"><link rel="modulepreload" href="/assets/development.html.22e330bb.js"><link rel="modulepreload" href="/assets/development.html.7ca41dab.js"><link rel="prefetch" href="/assets/index.html.6b70b98e.js"><link rel="prefetch" href="/assets/index.html.8c536146.js"><link rel="prefetch" href="/assets/API.html.e4493815.js"><link rel="prefetch" href="/assets/index.html.42144aac.js"><link rel="prefetch" href="/assets/VIP.html.7d6e7bc5.js"><link rel="prefetch" href="/assets/content.html.71fd6698.js"><link rel="prefetch" href="/assets/editor-config.html.1bfda6d8.js"><link rel="prefetch" href="/assets/for-frame.html.85772b72.js"><link rel="prefetch" href="/assets/for-ts.html.6c02f0f3.js"><link rel="prefetch" href="/assets/getting-started.html.c337ba6a.js"><link rel="prefetch" href="/assets/i18n.html.4324ce5f.js"><link rel="prefetch" href="/assets/installation.html.9def68b1.js"><link rel="prefetch" href="/assets/menu-config.html.d3ffbe27.js"><link rel="prefetch" href="/assets/node-define.html.21b93b30.js"><link rel="prefetch" href="/assets/plugins.html.c7c5e760.js"><link rel="prefetch" href="/assets/theme.html.1b28d484.js"><link rel="prefetch" href="/assets/toolbar-config.html.fb03bf2a.js"><link rel="prefetch" href="/assets/video-course.html.3fd50674.js"><link rel="prefetch" href="/assets/API.html.f0cb7d47.js"><link rel="prefetch" href="/assets/index.html.c7dd638a.js"><link rel="prefetch" href="/assets/content.html.9a78d07f.js"><link rel="prefetch" href="/assets/development.html.918618ff.js"><link rel="prefetch" href="/assets/editor-config.html.3ba51a16.js"><link rel="prefetch" href="/assets/for-frame.html.85177416.js"><link rel="prefetch" href="/assets/for-ts.html.fffd590a.js"><link rel="prefetch" href="/assets/getting-started.html.4c395196.js"><link rel="prefetch" href="/assets/i18n.html.c590d1ce.js"><link rel="prefetch" href="/assets/installation.html.41a3e20a.js"><link rel="prefetch" href="/assets/menu-config.html.4385b156.js"><link rel="prefetch" href="/assets/node-define.html.1a18ff24.js"><link rel="prefetch" href="/assets/plugins.html.3c1d0f26.js"><link rel="prefetch" href="/assets/theme.html.6c82f324.js"><link rel="prefetch" href="/assets/toolbar-config.html.c52832ff.js"><link rel="prefetch" href="/assets/404.html.93146c89.js"><link rel="prefetch" href="/assets/index.html.2d448b3d.js"><link rel="prefetch" href="/assets/index.html.830a595f.js"><link rel="prefetch" href="/assets/API.html.c48575bb.js"><link rel="prefetch" href="/assets/index.html.db0877f5.js"><link rel="prefetch" href="/assets/VIP.html.8b6da96a.js"><link rel="prefetch" href="/assets/content.html.beffdf87.js"><link rel="prefetch" href="/assets/editor-config.html.0a07d28e.js"><link rel="prefetch" href="/assets/for-frame.html.885f8977.js"><link rel="prefetch" href="/assets/for-ts.html.821b8319.js"><link rel="prefetch" href="/assets/getting-started.html.241d827a.js"><link rel="prefetch" href="/assets/i18n.html.0104f2b5.js"><link rel="prefetch" href="/assets/installation.html.febef836.js"><link rel="prefetch" href="/assets/menu-config.html.6ed94a9e.js"><link rel="prefetch" href="/assets/node-define.html.b6c5fc01.js"><link rel="prefetch" href="/assets/plugins.html.b9c8422b.js"><link rel="prefetch" href="/assets/theme.html.d7496b7d.js"><link rel="prefetch" href="/assets/toolbar-config.html.e189a672.js"><link rel="prefetch" href="/assets/video-course.html.88758937.js"><link rel="prefetch" href="/assets/API.html.576d3e0e.js"><link rel="prefetch" href="/assets/index.html.05dec220.js"><link rel="prefetch" href="/assets/content.html.6cecc771.js"><link rel="prefetch" href="/assets/development.html.14659540.js"><link rel="prefetch" href="/assets/editor-config.html.472db21d.js"><link rel="prefetch" href="/assets/for-frame.html.922b3e7e.js"><link rel="prefetch" href="/assets/for-ts.html.e8a9fcb1.js"><link rel="prefetch" href="/assets/getting-started.html.bd91d1d4.js"><link rel="prefetch" href="/assets/i18n.html.fa28315c.js"><link rel="prefetch" href="/assets/installation.html.75f1490f.js"><link rel="prefetch" href="/assets/menu-config.html.af41150b.js"><link rel="prefetch" href="/assets/node-define.html.902a6bff.js"><link rel="prefetch" href="/assets/plugins.html.13a0de6b.js"><link rel="prefetch" href="/assets/theme.html.0ac545c8.js"><link rel="prefetch" href="/assets/toolbar-config.html.c273bb07.js"><link rel="prefetch" href="/assets/404.html.771069f9.js"><link rel="prefetch" href="/assets/404.fb9855c1.js"><link rel="prefetch" href="/assets/Layout.3b0e8890.js">
    <link rel="stylesheet" href="/assets/style.e50a9a21.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/image/logo.png" alt="wangEditor"><span class="site-name can-hide">wangEditor</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/v5/getting-started.md" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/video-course.md" class="" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/demo/index.html" rel="noopener noreferrer" target="_blank" aria-label="Demo 示例"><!--[--><!--]--> Demo 示例 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/plugins.md" class="" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/wangeditor-team/wangEditor" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/v4/" rel="noopener noreferrer" target="_blank" aria-label="v4 版本"><!--[--><!--]--> v4 版本 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/v5/development.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/v5/development.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/v5/getting-started.md" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/video-course.md" class="" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/demo/index.html" rel="noopener noreferrer" target="_blank" aria-label="Demo 示例"><!--[--><!--]--> Demo 示例 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/plugins.md" class="" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/wangeditor-team/wangEditor" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/v4/" rel="noopener noreferrer" target="_blank" aria-label="v4 版本"><!--[--><!--]--> v4 版本 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/v5/development.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/v5/development.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/v5/" class="router-link-active sidebar-item sidebar-heading" aria-label="优势"><!--[--><!--]--> 优势 <!--[--><!--]--></a><!----></li><li><a href="/v5/installation.html" class="sidebar-item sidebar-heading" aria-label="安装"><!--[--><!--]--> 安装 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading">基础 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/getting-started.html" class="sidebar-item" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="/v5/for-frame.html" class="sidebar-item" aria-label="用于 Vue React"><!--[--><!--]--> 用于 Vue React <!--[--><!--]--></a><!----></li><li><a href="/v5/content.html" class="sidebar-item" aria-label="内容处理"><!--[--><!--]--> 内容处理 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">配置和 API <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/toolbar-config.html" class="sidebar-item" aria-label="工具栏配置"><!--[--><!--]--> 工具栏配置 <!--[--><!--]--></a><!----></li><li><a href="/v5/editor-config.html" class="sidebar-item" aria-label="编辑器配置"><!--[--><!--]--> 编辑器配置 <!--[--><!--]--></a><!----></li><li><a href="/v5/menu-config.html" class="sidebar-item" aria-label="菜单配置"><!--[--><!--]--> 菜单配置 <!--[--><!--]--></a><!----></li><li><a href="/v5/API.html" class="sidebar-item" aria-label="编辑器 API"><!--[--><!--]--> 编辑器 API <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">高级 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/node-define.html" class="sidebar-item" aria-label="节点数据结构"><!--[--><!--]--> 节点数据结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="自定义扩展新功能"><!--[--><!--]--> 自定义扩展新功能 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/development.html#注册新菜单" class="router-link-active router-link-exact-active sidebar-item" aria-label="注册新菜单"><!--[--><!--]--> 注册新菜单 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/development.html#buttonmenu" class="router-link-active router-link-exact-active sidebar-item" aria-label="ButtonMenu"><!--[--><!--]--> ButtonMenu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#selectmenu" class="router-link-active router-link-exact-active sidebar-item" aria-label="SelectMenu"><!--[--><!--]--> SelectMenu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#droppanelmenu" class="router-link-active router-link-exact-active sidebar-item" aria-label="DropPanelMenu"><!--[--><!--]--> DropPanelMenu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#modalmenu" class="router-link-active router-link-exact-active sidebar-item" aria-label="ModalMenu"><!--[--><!--]--> ModalMenu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#注册菜单到-wangeditor" class="router-link-active router-link-exact-active sidebar-item" aria-label="注册菜单到 wangEditor"><!--[--><!--]--> 注册菜单到 wangEditor <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#插入菜单到工具栏" class="router-link-active router-link-exact-active sidebar-item" aria-label="插入菜单到工具栏"><!--[--><!--]--> 插入菜单到工具栏 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/development.html#劫持编辑器事件和操作-插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="劫持编辑器事件和操作（插件）"><!--[--><!--]--> 劫持编辑器事件和操作（插件） <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/development.html#定义插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义插件"><!--[--><!--]--> 定义插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#注册插件到-wangeditor" class="router-link-active router-link-exact-active sidebar-item" aria-label="注册插件到 wangEditor"><!--[--><!--]--> 注册插件到 wangEditor <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/development.html#定义新元素" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义新元素"><!--[--><!--]--> 定义新元素 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/development.html#定义节点数据结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义节点数据结构"><!--[--><!--]--> 定义节点数据结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#定义-inline-和-void" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义 inline 和 void"><!--[--><!--]--> 定义 inline 和 void <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#在编辑器中渲染新元素" class="router-link-active router-link-exact-active sidebar-item" aria-label="在编辑器中渲染新元素"><!--[--><!--]--> 在编辑器中渲染新元素 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#把新元素转换为-html" class="router-link-active router-link-exact-active sidebar-item" aria-label="把新元素转换为 HTML"><!--[--><!--]--> 把新元素转换为 HTML <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/development.html#解析新元素-html-到编辑器" class="router-link-active router-link-exact-active sidebar-item" aria-label="解析新元素 HTML 到编辑器"><!--[--><!--]--> 解析新元素 HTML 到编辑器 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/development.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/v5/i18n.html" class="sidebar-item" aria-label="多语言"><!--[--><!--]--> 多语言 <!--[--><!--]--></a><!----></li><li><a href="/v5/theme.html" class="sidebar-item" aria-label="主题"><!--[--><!--]--> 主题 <!--[--><!--]--></a><!----></li><li><a href="/v5/for-ts.html" class="sidebar-item" aria-label="用于 Typescript"><!--[--><!--]--> 用于 Typescript <!--[--><!--]--></a><!----></li><li><a href="/v5/plugins.html" class="sidebar-item" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">资源 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/video-course.html" class="sidebar-item" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="自定义扩展新功能" tabindex="-1"><a class="header-anchor" href="#自定义扩展新功能" aria-hidden="true">#</a> 自定义扩展新功能</h1><p>快速了解可查看<a href="/v5/video-course.html" class="">视频教程</a>。</p><p>wangEditor 从 V5 开始，源码上就分离了 core editor 还有各个 module 。<br> core 是核心 API ，editor 负责汇总集成。所有的具体功能，都分布在各个 module 中来实现。</p><p><img src="/image/架构图.png" alt=""></p><p>基于这种扩展性，官方开发了几个常用的<a href="/v5/plugins.html" class="">插件</a>，其源码也可作为二次开发的参考。</p><h2 id="注册新菜单" tabindex="-1"><a class="header-anchor" href="#注册新菜单" aria-hidden="true">#</a> 注册新菜单</h2><p>菜单分为几种</p><ul><li>ButtonMenu 按钮菜单，如 加粗、斜体</li><li>SelectMenu 下拉菜单，如 标题、字体、行高</li><li>DropPanelMenu 下拉面板菜单，如 字体颜色、创建表格</li><li>ModalMenu 弹出框菜单，如 插入链接、插入网络图片</li></ul><h3 id="buttonmenu" tabindex="-1"><a class="header-anchor" href="#buttonmenu" aria-hidden="true">#</a> ButtonMenu</h3><p>可参考这个 <a href="https://www.wangeditor.com/demo/extend-menu.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 网页源码。在实际开发中，会用到很多 editor <a href="/v5/API.html" class="">API</a> 。</p><p>第一，定义菜单 class</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IButtonMenu<span class="token punctuation">,</span> IDomEditor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">MyButtonMenu</span> <span class="token keyword">implements</span> <span class="token class-name">IButtonMenu</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// class MyButtonMenu {                       // JS 语法</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;My menu title&#39;</span> <span class="token comment">// 自定义菜单标题</span>
        <span class="token comment">// this.iconSvg = &#39;&lt;svg&gt;...&lt;/svg&gt;&#39; // 可选</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token string">&#39;button&#39;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取菜单执行时的 value ，用不到则返回空 字符串或 false</span>
    <span class="token function">getValue</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// getValue(editor) {                              // JS 语法</span>
        <span class="token keyword">return</span> <span class="token string">&#39; hello &#39;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要激活（如选中加粗文本，“加粗”菜单会激活），用不到则返回 false</span>
    <span class="token function">isActive</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
    <span class="token comment">// isActive(editor) {                    // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要禁用（如选中 H1 ，“引用”菜单被禁用），用不到则返回 false</span>
    <span class="token function">isDisabled</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// isDisabled(editor) {                     // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 点击菜单时触发的函数</span>
    <span class="token function">exec</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// exec(editor, value) {                              // JS 语法</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isDisabled</span><span class="token punctuation">(</span>editor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
        editor<span class="token punctuation">.</span><span class="token function">insertText</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment">// value 即 this.value(editor) 的返回值</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>第二，<a href="#%E6%B3%A8%E5%86%8C%E8%8F%9C%E5%8D%95%E5%88%B0-wangeditor">注册菜单到 wangEditor</a></p><p>第三，<a href="#%E6%8F%92%E5%85%A5%E8%8F%9C%E5%8D%95%E5%88%B0%E5%B7%A5%E5%85%B7%E6%A0%8F">插入菜单到工具栏</a></p><p>到此，自定义菜单就已经注册成功了，参考这个 <a href="https://www.wangeditor.com/demo/extend-menu.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="selectmenu" tabindex="-1"><a class="header-anchor" href="#selectmenu" aria-hidden="true">#</a> SelectMenu</h3><p>可参考这个 <a href="https://www.wangeditor.com/demo/extend-menu-select.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 网页源码。在实际开发中，会用到很多 editor <a href="/v5/API.html" class="">API</a> 。</p><p>第一，定义菜单 class</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor<span class="token punctuation">,</span> ISelectMenu <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">MySelectMenu</span> <span class="token keyword">implements</span> <span class="token class-name">ISelectMenu</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// class MySelectMenu {                       // JS 语法</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;My Select Menu&#39;</span><span class="token punctuation">,</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token string">&#39;select&#39;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">60</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 下拉框的选项</span>
    <span class="token function">getOptions</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// getOptions(editor) {            // JS 语法</span>
        <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">&#39;beijing&#39;</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&#39;北京&#39;</span><span class="token punctuation">,</span> styleForRenderMenuList<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;font-size&#39;</span><span class="token operator">:</span> <span class="token string">&#39;32px&#39;</span><span class="token punctuation">,</span> <span class="token string-property property">&#39;font-weight&#39;</span><span class="token operator">:</span> <span class="token string">&#39;bold&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">&#39;shanghai&#39;</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&#39;上海&#39;</span><span class="token punctuation">,</span> selected<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">&#39;shenzhen&#39;</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&#39;深圳&#39;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
        <span class="token keyword">return</span> options
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要激活（如选中加粗文本，“加粗”菜单会激活），用不到则返回 false</span>
    <span class="token function">isActive</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// isActive(editor) {                      // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取菜单执行时的 value ，用不到则返回空 字符串或 false</span>
    <span class="token function">getValue</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// getValue(editor) {                               // JS 语法</span>
        <span class="token keyword">return</span> <span class="token string">&#39;shanghai&#39;</span> <span class="token comment">// 匹配 options 其中一个 value</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要禁用（如选中 H1 ，“引用”菜单被禁用），用不到则返回 false</span>
    <span class="token function">isDisabled</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// isDisabled(editor) {                     // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 点击菜单时触发的函数</span>
    <span class="token function">exec</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// exec(editor, value) {                              // JS 语法</span>
        <span class="token comment">// Select menu ，这个函数不用写，空着即可</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>第二，<a href="#%E6%B3%A8%E5%86%8C%E8%8F%9C%E5%8D%95%E5%88%B0-wangeditor">注册菜单到 wangEditor</a></p><p>第三，<a href="#%E6%8F%92%E5%85%A5%E8%8F%9C%E5%8D%95%E5%88%B0%E5%B7%A5%E5%85%B7%E6%A0%8F">插入菜单到工具栏</a></p><p>到此，自定义菜单就已经注册成功了，参考这个 <a href="https://www.wangeditor.com/demo/extend-menu-select.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="droppanelmenu" tabindex="-1"><a class="header-anchor" href="#droppanelmenu" aria-hidden="true">#</a> DropPanelMenu</h3><p>可参考这个 <a href="https://www.wangeditor.com/demo/extend-menu-drop-panel.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 网页源码。在实际开发中，会用到很多 editor <a href="/v5/API.html" class="">API</a> 。</p><p>第一，定义菜单 class</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor<span class="token punctuation">,</span> IDropPanelMenu <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">MyDropPanelMenu</span> <span class="token keyword">implements</span> <span class="token class-name">IDropPanelMenu</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
<span class="token comment">// class MyDropPanelMenu {                           // JS 语法</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;My menu&#39;</span>
        <span class="token comment">// this.iconSvg = &#39;&lt;svg &gt;...&lt;/svg&gt;&#39;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token string">&#39;button&#39;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showDropPanel <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要激活（如选中加粗文本，“加粗”菜单会激活），用不到则返回 false</span>
    <span class="token function">isActive</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// isActive(editor) {                      // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取菜单执行时的 value ，用不到则返回空 字符串或 false</span>
    <span class="token function">getValue</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// getValue(editor) {                               // JS 语法</span>
        <span class="token keyword">return</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要禁用（如选中 H1 ，“引用”菜单被禁用），用不到则返回 false</span>
    <span class="token function">isDisabled</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// isDisabled(editor) {                     // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 点击菜单时触发的函数</span>
    <span class="token function">exec</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// exec(editor, value) {                              // JS 语法</span>
        <span class="token comment">// DropPanel menu ，这个函数不用写，空着即可</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 定义 DropPanel 内部的 DOM Element</span>
    <span class="token function">getPanelContentElem</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> DOMElement <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// getPanelContentElem(editor) {                        // JS 语法</span>
        <span class="token keyword">const</span> $list <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;ul&gt;
            &lt;li&gt;北京&lt;/li&gt; &lt;li&gt;上海&lt;/li&gt; &lt;li&gt;深圳&lt;/li&gt;
          &lt;/ul&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

        $list<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;li&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          editor<span class="token punctuation">.</span><span class="token function">insertText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
          editor<span class="token punctuation">.</span><span class="token function">insertText</span><span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> $list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// 返回 DOM Element 类型</span>

        <span class="token comment">// PS：也可以把 $list 缓存下来，这样不用每次重复创建、重复绑定事件，优化性能</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>第二，<a href="#%E6%B3%A8%E5%86%8C%E8%8F%9C%E5%8D%95%E5%88%B0-wangeditor">注册菜单到 wangEditor</a></p><p>第三，<a href="#%E6%8F%92%E5%85%A5%E8%8F%9C%E5%8D%95%E5%88%B0%E5%B7%A5%E5%85%B7%E6%A0%8F">插入菜单到工具栏</a></p><p>到此，自定义菜单就已经注册成功了，参考这个 <a href="/v5/htthttps:/www.wangeditor.com/demo/extend-menu-drop-panel.html" class="">demo</a></p><h3 id="modalmenu" tabindex="-1"><a class="header-anchor" href="#modalmenu" aria-hidden="true">#</a> ModalMenu</h3><p>可参考这个 <a href="https://www.wangeditor.com/demo/extend-menu-modal.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 网页源码。在实际开发中，会用到很多 editor <a href="/v5/API.html" class="">API</a> 。</p><p>第一，定义菜单 class</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor<span class="token punctuation">,</span> IModalMenu<span class="token punctuation">,</span> SlateNode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">MyModalMenu</span> <span class="token keyword">implements</span> <span class="token class-name">IModalMenu</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
<span class="token comment">// class MyModalMenu {                       // JS 语法</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;My menu&#39;</span>
        <span class="token comment">// this.iconSvg = &#39;&lt;svg &gt;...&lt;/svg&gt;&#39;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token string">&#39;button&#39;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showModal <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>modalWidth <span class="token operator">=</span> <span class="token number">300</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要激活（如选中加粗文本，“加粗”菜单会激活），用不到则返回 false</span>
    <span class="token function">isActive</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// isActive(editor) {                      // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取菜单执行时的 value ，用不到则返回空 字符串或 false</span>
    <span class="token function">getValue</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>    <span class="token comment">// TS 语法</span>
    <span class="token comment">// getValue(editor) {                               // JS 语法</span>
        <span class="token keyword">return</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 菜单是否需要禁用（如选中 H1 ，“引用”菜单被禁用），用不到则返回 false</span>
    <span class="token function">isDisabled</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// isDisabled(editor) {                     // JS 语法</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 点击菜单时触发的函数</span>
    <span class="token function">exec</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// exec(editor, value) {                              // JS 语法</span>
        <span class="token comment">// Modal menu ，这个函数不用写，空着即可</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 弹出框 modal 的定位：1. 返回某一个 SlateNode； 2. 返回 null （根据当前选区自动定位）</span>
    <span class="token function">getModalPositionNode</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> SlateNode <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
    <span class="token comment">// getModalPositionNode(editor) {                             // JS 语法</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span> <span class="token comment">// modal 依据选区定位</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 定义 modal 内部的 DOM Element</span>
    <span class="token function">getModalContentElem</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> DOMElement <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
    <span class="token comment">// getModalContentElem(editor) {                        // JS 语法</span>

        <span class="token keyword">const</span> $content <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> $button <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;button&gt;do something&lt;/button&gt;&#39;</span><span class="token punctuation">)</span>
        $content<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$button<span class="token punctuation">)</span>

        $button<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            editor<span class="token punctuation">.</span><span class="token function">insertText</span><span class="token punctuation">(</span><span class="token string">&#39; hello &#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> $content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// 返回 DOM Element 类型</span>

        <span class="token comment">// PS：也可以把 $content 缓存下来，这样不用每次重复创建、重复绑定事件，优化性能</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>第二，<a href="#%E6%B3%A8%E5%86%8C%E8%8F%9C%E5%8D%95%E5%88%B0-wangeditor">注册菜单到 wangEditor</a></p><p>第三，<a href="#%E6%8F%92%E5%85%A5%E8%8F%9C%E5%8D%95%E5%88%B0%E5%B7%A5%E5%85%B7%E6%A0%8F">插入菜单到工具栏</a></p><p>到此，自定义菜单就已经注册成功了，参考这个 <a href="https://www.wangeditor.com/demo/extend-menu-modal.html" target="_blank" rel="noopener noreferrer">demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="用-vue-react-组件实现-modal" tabindex="-1"><a class="header-anchor" href="#用-vue-react-组件实现-modal" aria-hidden="true">#</a> 用 Vue React 组件实现 modal</h4><p>如果你用 Vue React 开发了 modal 组件，想通过菜单来显示/隐藏</p><ul><li>不用 ModalMenu ，改用最简单的 ButtonMenu</li><li>在 <code>exec</code> 函数中通过自定义事件（或其他方式）来控制 modal 组件的显示和隐藏</li></ul><p>可再参考这个分享：<a href="https://github.com/wangeditor-team/wangEditor/issues/4598" target="_blank" rel="noopener noreferrer">在 React 中更方便的扩展 Menu ，替代原有的 ModalMenu 方案<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="注册菜单到-wangeditor" tabindex="-1"><a class="header-anchor" href="#注册菜单到-wangeditor" aria-hidden="true">#</a> 注册菜单到 wangEditor</h3><p>先根据菜单 class 来定义菜单配置</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> menu1Conf <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;menu1&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 定义 menu key ：要保证唯一、不重复（重要）</span>
  <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">YourMenuClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 把 `YourMenuClass` 替换为你菜单的 class</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// const menu2Conf = { ... }</span>
<span class="token comment">// const menu3Conf = { ... }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>然后，再把菜单注册到 wangEditor 。有两种选择：</p><p>第一，如果只注册一个菜单，没有别的功能了，则推荐使用 <code>registerMenu</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

Boot<span class="token punctuation">.</span><span class="token function">registerMenu</span><span class="token punctuation">(</span>menu1Conf<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第二，如果除了菜单之外还要同时注册其他能力，则建议使用 <code>registerModule</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot<span class="token punctuation">,</span> IModuleConf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> module<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IModuleConf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// const module = {                      // JS 语法</span>

  menus<span class="token operator">:</span> <span class="token punctuation">[</span>menu1Conf<span class="token punctuation">,</span> menu2Conf<span class="token punctuation">,</span> menu3Conf<span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// 其他功能，下文讲解...</span>
<span class="token punctuation">}</span>
Boot<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>必须在创建编辑器之前注册</li><li>全局只能注册一次，不要重复注册</li></ul></div><h3 id="插入菜单到工具栏" tabindex="-1"><a class="header-anchor" href="#插入菜单到工具栏" aria-hidden="true">#</a> 插入菜单到工具栏</h3><p>在创建编辑器（或渲染 Vue React 组件时）注册到工具栏，可选择以下方式</p><ul><li>注册到工具栏 <a href="/v5/toolbar-config.html#insertkeys" class="">insertKeys</a></li><li>注册到悬浮菜单 <a href="/v5/editor-config.html#hoverbarkeys" class="">hoverbarKeys</a></li></ul><h2 id="劫持编辑器事件和操作-插件" tabindex="-1"><a class="header-anchor" href="#劫持编辑器事件和操作-插件" aria-hidden="true">#</a> 劫持编辑器事件和操作（插件）</h2><p>如<a href="https://github.com/wangeditor-team/wangEditor-plugin-md" target="_blank" rel="noopener noreferrer">支持 markdown 语法<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，以及 <a href="https://github.com/wangeditor-team/wangEditor-plugin-ctrl-enter" target="_blank" rel="noopener noreferrer">ctrl + enter 回车<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>等。可参考它们的源码。</p><h3 id="定义插件" tabindex="-1"><a class="header-anchor" href="#定义插件" aria-hidden="true">#</a> 定义插件</h3><p>在实际开发中，会用到很多 editor <a href="/v5/API.html" class="">API</a> 。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">withBreakAndDelete</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> IDomEditor<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>editor<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// function withBreakAndDelete(editor) {                            // JS 语法</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> insertBreak<span class="token punctuation">,</span> deleteBackward <span class="token punctuation">}</span> <span class="token operator">=</span> editor <span class="token comment">// 获取当前 editor API</span>
    <span class="token keyword">const</span> newEditor <span class="token operator">=</span> editor

    <span class="token comment">// 重写 insertBreak 换行</span>
    newEditor<span class="token punctuation">.</span><span class="token function-variable function">insertBreak</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// if: 是 ctrl + enter ，则执行 insertBreak</span>
        <span class="token function">insertBreak</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// else: 则不执行换行</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 重写 deleteBackward 向后删除</span>
    newEditor<span class="token punctuation">.</span><span class="token function-variable function">deleteBackward</span> <span class="token operator">=</span> unit <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// if： 某种情况下，执行默认的删除</span>
        <span class="token function">deleteBackward</span><span class="token punctuation">(</span>unit<span class="token punctuation">)</span>

        <span class="token comment">// else: 其他情况，则不执行删除</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 重写其他 API ...</span>

    <span class="token comment">// 返回 newEditor ，重要！</span>
    <span class="token keyword">return</span> newEditor
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="注册插件到-wangeditor" tabindex="-1"><a class="header-anchor" href="#注册插件到-wangeditor" aria-hidden="true">#</a> 注册插件到 wangEditor</h3><p>有两种方式。</p><p>第一，如果你仅仅注册一个插件，没有别的需求，则推荐使用 <code>registerPlugin</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

Boot<span class="token punctuation">.</span><span class="token function">registerPlugin</span><span class="token punctuation">(</span>withBreakAndDelete<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第二，如果你除了注册插件之外，同时还注册其他功能，则推荐使用 <code>registerModule</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot<span class="token punctuation">,</span> IModuleConf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> module<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IModuleConf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// const module = {                      // JS 语法</span>

  <span class="token comment">// menus: [menu1Conf, menu2Conf, menu3Conf], // 菜单</span>
  editorPlugin<span class="token operator">:</span> withBreakAndDelete<span class="token punctuation">,</span> <span class="token comment">// 插件</span>

  <span class="token comment">// 其他功能，下文讲解...</span>
<span class="token punctuation">}</span>
Boot<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>必须在创建编辑器之前注册</li><li>全局只能注册一次，不要重复注册</li></ul></div><p>至此一个插件就注册完成，可以监听编辑器的 <code>insertBreak</code> 和 <code>deleteBackward</code> 事件。</p><h2 id="定义新元素" tabindex="-1"><a class="header-anchor" href="#定义新元素" aria-hidden="true">#</a> 定义新元素</h2><p>编辑器默认只有基本的标题、列表、文字、图片、表格等元素，如果你想让编辑器渲染一个新元素，如 <a href="https://github.com/wangeditor-team/wangEditor-plugin-upload-attachment" target="_blank" rel="noopener noreferrer">附件<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="https://github.com/wangeditor-team/wangEditor-plugin-formula" target="_blank" rel="noopener noreferrer">数学公式<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="https://github.com/wangeditor-team/wangEditor-plugin-link-card" target="_blank" rel="noopener noreferrer">链接卡片<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 等，你就需要根据本节内容来定义。</p><p>编辑器的输入和输出通常都是 HTML ，但其内部却有复杂的渲染机制，主要过程是：<strong>model -&gt; 生成 vdom -&gt; 渲染 DOM</strong>，如下图。</p><p>所以，我们也需要了解很多知识，定义很多函数来完成这一功能。不过别担心，它其实并难理解，跟着文档一步一步操作即可。</p><p><img src="/image/extend-api.png" alt=""></p><h3 id="定义节点数据结构" tabindex="-1"><a class="header-anchor" href="#定义节点数据结构" aria-hidden="true">#</a> 定义节点数据结构</h3><p>数据驱动视图，这也是 Vue React 设计思路。要想显示什么，必须先定义相应的数据结构。</p><p>在此需要你详细了解 wangEditor <a href="/v5/node-define.html" class="">节点数据结构</a>的相关知识，并熟悉以下知识点：</p><ul><li>Text node 和 Element node 区别</li><li>如何扩展 Text node 和 Element node 属性</li><li>如何设置 Inline node</li><li>如何设置 Void node ，以及它的 <code>children</code> 有何特点</li></ul><p>例如，对“附件”元素，我们设计为： <code>type: &#39;attachment&#39;</code> + inline + void ，然后扩展一些必要的属性，数据结构示例：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> myResume<span class="token operator">:</span> AttachmentElement <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
<span class="token comment">// const resume = {                    // JS 语法</span>
  type<span class="token operator">:</span> <span class="token string">&#39;attachment&#39;</span>
  fileName<span class="token operator">:</span> <span class="token string">&#39;resume.pdf&#39;</span>
  link<span class="token operator">:</span> <span class="token string">&#39;https://xxx.com/files/resume.pdf&#39;</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>  <span class="token comment">// void 元素必须有一个 children ，其中只有一个空字符串，重要！！！</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果你使用 TS ， <code>AttachmentElement</code> 的定义在<a href="https://github.com/wangeditor-team/wangEditor-plugin-upload-attachment/blob/main/src/module/custom-types.ts" target="_blank" rel="noopener noreferrer">这里<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="定义-inline-和-void" tabindex="-1"><a class="header-anchor" href="#定义-inline-和-void" aria-hidden="true">#</a> 定义 inline 和 void</h3><p>我们把“附件”元素设计为 inline 和 void ，就需要在代码中体现出来。</p><p>第一，定义一个插件，重写 <code>isInline</code> 和 <code>isVoid</code> API</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> DomEditor<span class="token punctuation">,</span> IDomEditor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">withAttachment</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> IDomEditor<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>editor<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
<span class="token comment">// function withAttachment(editor) {                        // JS 语法</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isInline<span class="token punctuation">,</span> isVoid <span class="token punctuation">}</span> <span class="token operator">=</span> editor
  <span class="token keyword">const</span> newEditor <span class="token operator">=</span> editor

  newEditor<span class="token punctuation">.</span><span class="token function-variable function">isInline</span> <span class="token operator">=</span> elem <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> DomEditor<span class="token punctuation">.</span><span class="token function">getNodeType</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span> <span class="token comment">// 针对 type: attachment ，设置为 inline</span>
    <span class="token keyword">return</span> <span class="token function">isInline</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  newEditor<span class="token punctuation">.</span><span class="token function-variable function">isVoid</span> <span class="token operator">=</span> elem <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> DomEditor<span class="token punctuation">.</span><span class="token function">getNodeType</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span> <span class="token comment">// 针对 type: attachment ，设置为 void</span>
    <span class="token keyword">return</span> <span class="token function">isVoid</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> newEditor <span class="token comment">// 返回 newEditor ，重要！！！</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>第二，把插件 <code>withAttachment</code> 注册到 wangEditor ，参考<a href="#%E6%B3%A8%E5%86%8C%E6%8F%92%E4%BB%B6%E5%88%B0-wangeditor">上文</a>。</p><h3 id="在编辑器中渲染新元素" tabindex="-1"><a class="header-anchor" href="#在编辑器中渲染新元素" aria-hidden="true">#</a> 在编辑器中渲染新元素</h3><p>数据结构定义好了，但编辑器现在还不认识它，执行 <code>editor.insertNode(myResume)</code> 也不会有任何效果。接下来就需要让编辑器认识它，能根据 <code>myResume</code> 的数据，渲染出我们想要的 UI 界面。</p><h4 id="安装-snabbdom-js" tabindex="-1"><a class="header-anchor" href="#安装-snabbdom-js" aria-hidden="true">#</a> 安装 snabbdom.js</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> snabbdom --peer
<span class="token comment">## 安装到 package.json 的 peerDependencies 中即可</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>编辑器的内部渲染使用了 VDOM 技术，<a href="https://github.com/snabbdom/snabbdom" target="_blank" rel="noopener noreferrer">snabbdom.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 是一个优秀的 VDOM diff 工具。</p><p>我们主要会用到它的 <code>h</code> 函数，你可以先在<a href="https://github.com/snabbdom/snabbdom#h" target="_blank" rel="noopener noreferrer">文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中了解一下。</p><h4 id="定义-renderelem-函数" tabindex="-1"><a class="header-anchor" href="#定义-renderelem-函数" aria-hidden="true">#</a> 定义 renderElem 函数</h4><p>以下是“附件”元素 renderElem 的代码示例，完整代码请参考它的<a href="https://github.com/wangeditor-team/wangEditor-plugin-upload-attachment/blob/main/src/module/render-elem.ts" target="_blank" rel="noopener noreferrer">源码<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h<span class="token punctuation">,</span> VNode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;snabbdom&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor<span class="token punctuation">,</span> SlateElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token doc-comment comment">/**
 * 渲染“附件”元素到编辑器
 * <span class="token keyword">@param</span> <span class="token parameter">elem</span> 附件元素，即上文的 myResume
 * <span class="token keyword">@param</span> <span class="token parameter">children</span> 元素子节点，void 元素可忽略
 * <span class="token keyword">@param</span> <span class="token parameter">editor</span> 编辑器实例
 * <span class="token keyword">@returns</span> vnode 节点（通过 snabbdom.js 的 h 函数生成）
 */</span>
<span class="token keyword">function</span> <span class="token function">renderAttachment</span><span class="token punctuation">(</span>elem<span class="token operator">:</span> SlateElement<span class="token punctuation">,</span> children<span class="token operator">:</span> VNode<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> VNode <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
<span class="token comment">// function renderAttachment(elem, children, editor) {                                                // JS 语法</span>

    <span class="token comment">// 获取“附件”的数据，参考上文 myResume 数据结构</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fileName <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> link <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> elem

    <span class="token comment">// 附件 icon 图标 vnode</span>
    <span class="token keyword">const</span> iconVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>
        <span class="token comment">// HTML tag</span>
        <span class="token string">&#39;img&#39;</span><span class="token punctuation">,</span>
        <span class="token comment">// HTML 属性</span>
        <span class="token punctuation">{</span>
            props<span class="token operator">:</span> <span class="token punctuation">{</span> src<span class="token operator">:</span> <span class="token string">&#39;xxxx.png&#39;</span> <span class="token punctuation">}</span> <span class="token comment">// HTML 属性，驼峰式写法</span>
            style<span class="token operator">:</span> <span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token string">&#39;1em&#39;</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span> <span class="token string">&#39;0.1em&#39;</span><span class="token punctuation">,</span>  <span class="token comment">/* 其他... */</span> <span class="token punctuation">}</span> <span class="token comment">// HTML style ，驼峰式写法</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// img 没有子节点，所以第三个参数不用写</span>
    <span class="token punctuation">)</span>

    <span class="token comment">// 附件元素 vnode</span>
    <span class="token keyword">const</span> attachVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>
        <span class="token comment">// HTML tag</span>
        <span class="token string">&#39;span&#39;</span><span class="token punctuation">,</span>
        <span class="token comment">// HTML 属性、样式、事件</span>
        <span class="token punctuation">{</span>
            props<span class="token operator">:</span> <span class="token punctuation">{</span> contentEditable<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// HTML 属性，驼峰式写法</span>
            style<span class="token operator">:</span> <span class="token punctuation">{</span> display<span class="token operator">:</span> <span class="token string">&#39;inline-block&#39;</span><span class="token punctuation">,</span> marginLeft<span class="token operator">:</span> <span class="token string">&#39;3px&#39;</span><span class="token punctuation">,</span> <span class="token comment">/* 其他... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// style ，驼峰式写法</span>
            on<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;clicked&#39;</span><span class="token punctuation">,</span> link<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">/* 其他... */</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 子节点</span>
        <span class="token punctuation">[</span> iconVnode<span class="token punctuation">,</span> fileName <span class="token punctuation">]</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">return</span> attachVnode
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h4 id="注册-renderelem-到-wangeditor" tabindex="-1"><a class="header-anchor" href="#注册-renderelem-到-wangeditor" aria-hidden="true">#</a> 注册 renderElem 到 wangEditor</h4><p>先定义 renderElem 配置</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> renderElemConf <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 新元素 type ，重要！！！</span>
  <span class="token literal-property property">renderElem</span><span class="token operator">:</span> renderAttachment<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后把 <code>renderElemConf</code> 注册到 wangEditor ，有两种方式。</p><p>第一，如果你只想注册一个 renderElem ，没有其他功能，推荐使用 <code>registerRenderElem</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

Boot<span class="token punctuation">.</span><span class="token function">registerRenderElem</span><span class="token punctuation">(</span>renderElemConf<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第二，如果你除了 renderElem 同时还要注册其他功能，推荐使用 <code>registerModule</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot<span class="token punctuation">,</span> IModuleConf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> module<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IModuleConf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// const module = {                      // JS 语法</span>

  <span class="token comment">// menus: [menu1Conf, menu2Conf, menu3Conf], // 菜单</span>
  <span class="token comment">// editorPlugin: withBreakAndDelete, // 插件</span>
  renderElems<span class="token operator">:</span> <span class="token punctuation">[</span>renderElemConf<span class="token punctuation">,</span> <span class="token comment">/* 其他元素... */</span><span class="token punctuation">]</span> <span class="token comment">// renderElem</span>

  <span class="token comment">// 其他功能，下文讲解...</span>
<span class="token punctuation">}</span>
Boot<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>必须在创建编辑器之前注册</li><li>全局只能注册一次，不要重复注册</li></ul></div><p>此时，你再执行 <code>editor.insertNode(myResume)</code> 就可以看到“附件”元素被渲染到了编辑器中。</p><h3 id="把新元素转换为-html" tabindex="-1"><a class="header-anchor" href="#把新元素转换为-html" aria-hidden="true">#</a> 把新元素转换为 HTML</h3><p>当你把 <code>myResume</code> 插入到编辑器，并渲染成功，此时执行 <code>editor.getHtml()</code> 获取的 HTML 里并没有“附件”元素。接下来需要定义如何输入 HTML 。</p><h4 id="定义-elemtohtml-函数" tabindex="-1"><a class="header-anchor" href="#定义-elemtohtml-函数" aria-hidden="true">#</a> 定义 elemToHtml 函数</h4><p>以下是代码示例，完整源码可参考<a href="https://github.com/wangeditor-team/wangEditor-plugin-upload-attachment/blob/main/src/module/elem-to-html.ts" target="_blank" rel="noopener noreferrer">这里<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> SlateElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token doc-comment comment">/**
 * 生成“附件”元素的 HTML
 * <span class="token keyword">@param</span> <span class="token parameter">elem</span> 附件元素，即上文的 myResume
 * <span class="token keyword">@param</span> <span class="token parameter">childrenHtml</span> 子节点的 HTML 代码，void 元素可忽略
 * <span class="token keyword">@returns</span> “附件”元素的 HTML 字符串
 */</span>
<span class="token keyword">function</span> <span class="token function">attachmentToHtml</span><span class="token punctuation">(</span>elem<span class="token operator">:</span> SlateElement<span class="token punctuation">,</span> childrenHtml<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
<span class="token comment">// function attachmentToHtml(elem, childrenHtml) {                             // JS 语法</span>

  <span class="token comment">// 获取附件元素的数据</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> link <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> fileName <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> elem

  <span class="token comment">// 生成 HTML 代码</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span
        data-w-e-type=&quot;attachment&quot;
        data-w-e-is-void
        data-w-e-is-inline
        data-link=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>link<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;
        data-fileName=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;
    &gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span>

  <span class="token keyword">return</span> html
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>注意以下事项：</p><ul><li>自定义元素生成的 HTML tag 尽量使用 <code>&lt;div&gt;</code>（针对 block 元素） 或 <code>&lt;span&gt;</code>（针对 inline 元素）等通用标签。<strong>谨慎使用 <code>&lt;a&gt;</code> <code>&lt;p&gt;</code> <code>&lt;table&gt;</code> 等编辑器默认支持的标签，那可能会带来冲突</strong>。</li><li>使用 <code>data-w-e-type</code> 记录元素 <code>type</code> ，以便解析 HTML 时（下文讲）能识别到</li><li>使用 <code>data-w-e-is-void</code> 标记元素是 void ，以便解析 HTML 时能识别</li><li>使用 <code>data-w-e-is-inline</code> 标记元素是 inline ，以便解析 HTML 时能识别</li><li>HTML 结构尽量扁平、简洁，这样更容易解析 HTML ，更稳定</li></ul><h4 id="注册-elemtohtml-到-wangeditor" tabindex="-1"><a class="header-anchor" href="#注册-elemtohtml-到-wangeditor" aria-hidden="true">#</a> 注册 elemToHtml 到 wangEditor</h4><p>先定义 elemToHtml 配置</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> elemToHtmlConf <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 新元素的 type ，重要！！！</span>
  elemToHtml<span class="token operator">:</span> attachmentToHtml<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后注册到 wangEditor ，有两种方式</p><p>第一，如果你只想注册 elemToHtml ，没有其他需求，则推荐使用 <code>registerElemToHtml</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

Boot<span class="token punctuation">.</span><span class="token function">registerElemToHtml</span><span class="token punctuation">(</span>elemToHtmlConf<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第二，如果你除了注册 elemToHtml 之外，还需要注册其他功能，则推荐使用 <code>registerModule</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot<span class="token punctuation">,</span> IModuleConf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> module<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IModuleConf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// const module = {                      // JS 语法</span>

  <span class="token comment">// menus: [menu1Conf, menu2Conf, menu3Conf], // 菜单</span>
  <span class="token comment">// editorPlugin: withBreakAndDelete, // 插件</span>
  <span class="token comment">// renderElems: [renderElemConf],    // renderElem</span>
  elemsToHtml<span class="token operator">:</span> <span class="token punctuation">[</span>elemToHtmlConf<span class="token punctuation">,</span> <span class="token comment">/* 其他元素... */</span><span class="token punctuation">]</span>  <span class="token comment">// elemToHtml</span>

  <span class="token comment">// 其他功能，下文讲解...</span>
<span class="token punctuation">}</span>
Boot<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>必须在创建编辑器之前注册</li><li>全局只能注册一次，不要重复注册</li></ul></div><p>此时，你再执行 <code>editor.getHtml()</code> 即可得到“附件”元素的 HTML 代码，显示 HTML 时可配合 JS 实现点击下载附件的效果。</p><h3 id="解析新元素-html-到编辑器" tabindex="-1"><a class="header-anchor" href="#解析新元素-html-到编辑器" aria-hidden="true">#</a> 解析新元素 HTML 到编辑器</h3><p>通过 <code>const html = editor.getHtml()</code> 可以得到正确的 HTML ，但再去设置 HTML <code>editor.setHtml(html)</code> 却无效。需要你自定义解析 HTML 的逻辑。</p><h4 id="定义-parseelemhtml-函数" tabindex="-1"><a class="header-anchor" href="#定义-parseelemhtml-函数" aria-hidden="true">#</a> 定义 parseElemHtml 函数</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IDomEditor<span class="token punctuation">,</span> SlateDescendant<span class="token punctuation">,</span> SlateElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token doc-comment comment">/**
 * 解析 HTML 字符串，生成“附件”元素
 * <span class="token keyword">@param</span> <span class="token parameter">domElem</span> HTML 对应的 DOM Element
 * <span class="token keyword">@param</span> <span class="token parameter">children</span> 子节点
 * <span class="token keyword">@param</span> <span class="token parameter">editor</span> editor 实例
 * <span class="token keyword">@returns</span> “附件”元素，如上文的 myResume
 */</span>
<span class="token keyword">function</span> <span class="token function">parseAttachmentHtml</span><span class="token punctuation">(</span>domElem<span class="token operator">:</span> Element<span class="token punctuation">,</span> children<span class="token operator">:</span> SlateDescendant<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> editor<span class="token operator">:</span> IDomEditor<span class="token punctuation">)</span><span class="token operator">:</span> SlateElement <span class="token punctuation">{</span>  <span class="token comment">// TS 语法</span>
<span class="token comment">// function parseAttachmentHtml(domElem, children, editor) {                                                     // JS 语法</span>

  <span class="token comment">// 从 DOM element 中获取“附件”的信息</span>
  <span class="token keyword">const</span> link <span class="token operator">=</span> domElem<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-link&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">const</span> fileName <span class="token operator">=</span> domElem<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;data-fileName&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>

  <span class="token comment">// 生成“附件”元素（按照此前约定的数据结构）</span>
  <span class="token keyword">const</span> myResume <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">,</span>
    link<span class="token punctuation">,</span>
    fileName<span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// void node 必须有 children ，其中有一个空字符串，重要！！！</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> myResume
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="注册-parseelemhtml-到-wangeditor" tabindex="-1"><a class="header-anchor" href="#注册-parseelemhtml-到-wangeditor" aria-hidden="true">#</a> 注册 parseElemHtml 到 wangEditor</h4><p>先定义 parseHtml 配置</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> parseHtmlConf <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">selector</span><span class="token operator">:</span> <span class="token string">&#39;span[data-w-e-type=&quot;attachment&quot;]&#39;</span><span class="token punctuation">,</span> <span class="token comment">// CSS 选择器，匹配特定的 HTML 标签</span>
  <span class="token literal-property property">parseElemHtml</span><span class="token operator">:</span> parseAttachmentHtml<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后把 <code>parseHtmlConf</code> 注册到 wangEditor ，有两种方式：</p><p>第一，如果你只想注册一个 parseElemHtml ，没有别的功能，则推荐 <code>registerParseElemHtml</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

Boot<span class="token punctuation">.</span><span class="token function">registerParseElemHtml</span><span class="token punctuation">(</span>parseHtmlConf<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>第二，如果你除了想注册 parseElemHtml ，还想注册其他功能，则推荐 <code>registerModule</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Boot<span class="token punctuation">,</span> IModuleConf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> module<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IModuleConf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">// TS 语法</span>
<span class="token comment">// const module = {                      // JS 语法</span>

  <span class="token comment">// menus: [menu1Conf, menu2Conf, menu3Conf], // 菜单</span>
  <span class="token comment">// editorPlugin: withBreakAndDelete, // 插件</span>
  <span class="token comment">// renderElems: [renderElemConf],    // renderElem</span>
  <span class="token comment">// elemsToHtml: [elemToHtmlConf],    // elemToHtml</span>
  parseElemsHtml<span class="token operator">:</span> <span class="token punctuation">[</span>parseHtmlConf<span class="token punctuation">,</span> <span class="token comment">/* 其他元素... */</span><span class="token punctuation">]</span>  <span class="token comment">// parseElemHtml</span>
<span class="token punctuation">}</span>
Boot<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><ul><li>必须在创建编辑器之前注册</li><li>全局只能注册一次，不要重复注册</li></ul></div><p>此时，再把获取的 HTML 设置到编辑器中 <code>editor.setHtml(html)</code> 即可成功显示“附件”元素。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>一个模块常用代码文件如下，共选择参考（不一定都用到）</p><ul><li>render-elem.ts</li><li>elem-to-html.ts</li><li>parse-elem-html.ts</li><li>plugin.ts</li><li>menu/ <ul><li>Menu1.ts</li><li>Menu2.ts</li></ul></li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: wangfupeng1988@163.com">王福朋</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/v5/node-define.html" class="" aria-label="节点数据结构"><!--[--><!--]--> 节点数据结构 <!--[--><!--]--></a></span><span class="next"><a href="/v5/i18n.html" class="" aria-label="多语言"><!--[--><!--]--> 多语言 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.62bc27ba.js" defer></script>
  </body>
</html>
