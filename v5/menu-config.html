<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.41">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?a25f260386e515f4eee3e0a6bb4166be";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
            </script><title>菜单配置 | wangEditor</title><meta name="description" content="开源 Web 富文本编辑器，开箱即用，配置简单">
    <link rel="modulepreload" href="/assets/app.a87fb4fe.js"><link rel="modulepreload" href="/assets/menu-config.html.9f13e8af.js"><link rel="modulepreload" href="/assets/menu-config.html.2840f5a5.js"><link rel="prefetch" href="/assets/index.html.f90f0a51.js"><link rel="prefetch" href="/assets/index.html.b184a4f9.js"><link rel="prefetch" href="/assets/API.html.a5f5a164.js"><link rel="prefetch" href="/assets/index.html.0a8c2135.js"><link rel="prefetch" href="/assets/content.html.88b8584e.js"><link rel="prefetch" href="/assets/development.html.33da088c.js"><link rel="prefetch" href="/assets/editor-config.html.84f1cbfd.js"><link rel="prefetch" href="/assets/for-frame.html.bb0fb59c.js"><link rel="prefetch" href="/assets/for-ts.html.96af2cbe.js"><link rel="prefetch" href="/assets/getting-started.html.e6dee104.js"><link rel="prefetch" href="/assets/i18n.html.5d28db31.js"><link rel="prefetch" href="/assets/installation.html.3feecd0e.js"><link rel="prefetch" href="/assets/node-define.html.47e76623.js"><link rel="prefetch" href="/assets/plugins.html.b0b0c4e2.js"><link rel="prefetch" href="/assets/theme.html.d8760487.js"><link rel="prefetch" href="/assets/toolbar-config.html.ed4a1ae2.js"><link rel="prefetch" href="/assets/video-course.html.5802d395.js"><link rel="prefetch" href="/assets/API.html.d0e448f2.js"><link rel="prefetch" href="/assets/index.html.d3e8166e.js"><link rel="prefetch" href="/assets/content.html.0a5b4ed3.js"><link rel="prefetch" href="/assets/development.html.9e498029.js"><link rel="prefetch" href="/assets/editor-config.html.e77b82f2.js"><link rel="prefetch" href="/assets/for-frame.html.5daab0d1.js"><link rel="prefetch" href="/assets/for-ts.html.8702bb32.js"><link rel="prefetch" href="/assets/getting-started.html.2190e167.js"><link rel="prefetch" href="/assets/i18n.html.238aeb23.js"><link rel="prefetch" href="/assets/installation.html.8007a7f3.js"><link rel="prefetch" href="/assets/menu-config.html.fcb8888c.js"><link rel="prefetch" href="/assets/node-define.html.f41f3d94.js"><link rel="prefetch" href="/assets/plugins.html.9b5e0156.js"><link rel="prefetch" href="/assets/theme.html.a7e4637a.js"><link rel="prefetch" href="/assets/toolbar-config.html.ca0ea63e.js"><link rel="prefetch" href="/assets/404.html.93146c89.js"><link rel="prefetch" href="/assets/index.html.02e7094c.js"><link rel="prefetch" href="/assets/index.html.a04ddb0c.js"><link rel="prefetch" href="/assets/API.html.b792aac4.js"><link rel="prefetch" href="/assets/index.html.75c93973.js"><link rel="prefetch" href="/assets/content.html.a781077f.js"><link rel="prefetch" href="/assets/development.html.d5547423.js"><link rel="prefetch" href="/assets/editor-config.html.0922722c.js"><link rel="prefetch" href="/assets/for-frame.html.716818c8.js"><link rel="prefetch" href="/assets/for-ts.html.33d79ece.js"><link rel="prefetch" href="/assets/getting-started.html.53161fa2.js"><link rel="prefetch" href="/assets/i18n.html.1e43ec72.js"><link rel="prefetch" href="/assets/installation.html.8e7838f9.js"><link rel="prefetch" href="/assets/node-define.html.8d4c44d6.js"><link rel="prefetch" href="/assets/plugins.html.8501f719.js"><link rel="prefetch" href="/assets/theme.html.5fa02ea0.js"><link rel="prefetch" href="/assets/toolbar-config.html.c1e569f4.js"><link rel="prefetch" href="/assets/video-course.html.201e6bd2.js"><link rel="prefetch" href="/assets/API.html.586d39d2.js"><link rel="prefetch" href="/assets/index.html.0a5ade53.js"><link rel="prefetch" href="/assets/content.html.7c79bfd1.js"><link rel="prefetch" href="/assets/development.html.4c33c47d.js"><link rel="prefetch" href="/assets/editor-config.html.fea5d92b.js"><link rel="prefetch" href="/assets/for-frame.html.973256dc.js"><link rel="prefetch" href="/assets/for-ts.html.d15a5914.js"><link rel="prefetch" href="/assets/getting-started.html.fbb22460.js"><link rel="prefetch" href="/assets/i18n.html.8f4bb354.js"><link rel="prefetch" href="/assets/installation.html.c3683fb7.js"><link rel="prefetch" href="/assets/menu-config.html.8d53c088.js"><link rel="prefetch" href="/assets/node-define.html.429b4b1a.js"><link rel="prefetch" href="/assets/plugins.html.e2a7103e.js"><link rel="prefetch" href="/assets/theme.html.dbdb192c.js"><link rel="prefetch" href="/assets/toolbar-config.html.c00662b3.js"><link rel="prefetch" href="/assets/404.html.980f1943.js"><link rel="prefetch" href="/assets/404.945708f2.js"><link rel="prefetch" href="/assets/Layout.db49e708.js">
    <link rel="stylesheet" href="/assets/style.e50a9a21.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/image/logo.png" alt="wangEditor"><span class="site-name can-hide">wangEditor</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/v5/getting-started.md" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/video-course.md" class="" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/demo/index.html" rel="noopener noreferrer" target="_blank" aria-label="Demo"><!--[--><!--]--> Demo <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/plugins.md" class="" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/wangeditor-team/wangEditor" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/v4/" rel="noopener noreferrer" target="_blank" aria-label="v4 版本"><!--[--><!--]--> v4 版本 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/v5/menu-config.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/v5/menu-config.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/v5/getting-started.md" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/video-course.md" class="" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/demo/index.html" rel="noopener noreferrer" target="_blank" aria-label="Demo"><!--[--><!--]--> Demo <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/v5/plugins.md" class="" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/wangeditor-team/wangEditor" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.wangeditor.com/v4/" rel="noopener noreferrer" target="_blank" aria-label="v4 版本"><!--[--><!--]--> v4 版本 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/v5/menu-config.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/v5/menu-config.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/v5/" class="router-link-active sidebar-item sidebar-heading" aria-label="优势"><!--[--><!--]--> 优势 <!--[--><!--]--></a><!----></li><li><a href="/v5/installation.html" class="sidebar-item sidebar-heading" aria-label="安装"><!--[--><!--]--> 安装 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading">基础 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/getting-started.html" class="sidebar-item" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="/v5/content.html" class="sidebar-item" aria-label="内容处理"><!--[--><!--]--> 内容处理 <!--[--><!--]--></a><!----></li><li><a href="/v5/for-frame.html" class="sidebar-item" aria-label="用于 Vue React"><!--[--><!--]--> 用于 Vue React <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">配置和 API <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/toolbar-config.html" class="sidebar-item" aria-label="工具栏配置"><!--[--><!--]--> 工具栏配置 <!--[--><!--]--></a><!----></li><li><a href="/v5/editor-config.html" class="sidebar-item" aria-label="编辑器配置"><!--[--><!--]--> 编辑器配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="菜单配置"><!--[--><!--]--> 菜单配置 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/menu-config.html#通用方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="通用方法"><!--[--><!--]--> 通用方法 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/menu-config.html#确定-menu-key" class="router-link-active router-link-exact-active sidebar-item" aria-label="确定 menu key"><!--[--><!--]--> 确定 menu key <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#获取菜单的默认配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="获取菜单的默认配置"><!--[--><!--]--> 获取菜单的默认配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#修改配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="修改配置"><!--[--><!--]--> 修改配置 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/menu-config.html#颜色" class="router-link-active router-link-exact-active sidebar-item" aria-label="颜色"><!--[--><!--]--> 颜色 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#字号" class="router-link-active router-link-exact-active sidebar-item" aria-label="字号"><!--[--><!--]--> 字号 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#字体" class="router-link-active router-link-exact-active sidebar-item" aria-label="字体"><!--[--><!--]--> 字体 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#行高" class="router-link-active router-link-exact-active sidebar-item" aria-label="行高"><!--[--><!--]--> 行高 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#表情" class="router-link-active router-link-exact-active sidebar-item" aria-label="表情"><!--[--><!--]--> 表情 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#链接" class="router-link-active router-link-exact-active sidebar-item" aria-label="链接"><!--[--><!--]--> 链接 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="图片"><!--[--><!--]--> 图片 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#上传图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="上传图片"><!--[--><!--]--> 上传图片 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/menu-config.html#服务端地址" class="router-link-active router-link-exact-active sidebar-item" aria-label="服务端地址"><!--[--><!--]--> 服务端地址 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#基本配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本配置"><!--[--><!--]--> 基本配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#回调函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="回调函数"><!--[--><!--]--> 回调函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#自定义功能" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义功能"><!--[--><!--]--> 自定义功能 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#base64-插入图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="base64 插入图片"><!--[--><!--]--> base64 插入图片 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#获取已删除的图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="获取已删除的图片"><!--[--><!--]--> 获取已删除的图片 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/menu-config.html#视频" class="router-link-active router-link-exact-active sidebar-item" aria-label="视频"><!--[--><!--]--> 视频 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#上传视频" class="router-link-active router-link-exact-active sidebar-item" aria-label="上传视频"><!--[--><!--]--> 上传视频 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/v5/menu-config.html#服务端地址-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="服务端地址"><!--[--><!--]--> 服务端地址 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#基本配置-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本配置"><!--[--><!--]--> 基本配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#回调函数-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="回调函数"><!--[--><!--]--> 回调函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#自定义功能-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义功能"><!--[--><!--]--> 自定义功能 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/v5/menu-config.html#代码高亮" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码高亮"><!--[--><!--]--> 代码高亮 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/v5/menu-config.html#其他" class="router-link-active router-link-exact-active sidebar-item" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/v5/API.html" class="sidebar-item" aria-label="编辑器 API"><!--[--><!--]--> 编辑器 API <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">高级 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/node-define.html" class="sidebar-item" aria-label="节点数据结构"><!--[--><!--]--> 节点数据结构 <!--[--><!--]--></a><!----></li><li><a href="/v5/development.html" class="sidebar-item" aria-label="自定义扩展新功能"><!--[--><!--]--> 自定义扩展新功能 <!--[--><!--]--></a><!----></li><li><a href="/v5/i18n.html" class="sidebar-item" aria-label="多语言"><!--[--><!--]--> 多语言 <!--[--><!--]--></a><!----></li><li><a href="/v5/theme.html" class="sidebar-item" aria-label="主题"><!--[--><!--]--> 主题 <!--[--><!--]--></a><!----></li><li><a href="/v5/for-ts.html" class="sidebar-item" aria-label="用于 Typescript"><!--[--><!--]--> 用于 Typescript <!--[--><!--]--></a><!----></li><li><a href="/v5/plugins.html" class="sidebar-item" aria-label="插件"><!--[--><!--]--> 插件 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">资源 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/v5/video-course.html" class="sidebar-item" aria-label="视频教程"><!--[--><!--]--> 视频教程 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="菜单配置" tabindex="-1"><a class="header-anchor" href="#菜单配置" aria-hidden="true">#</a> 菜单配置</h1><p>本文是各个菜单项的详细配置。如想要自定义工具栏的菜单（隐藏某些菜单、排序、分组等），请参考<a href="/v5/toolbar-config.html" class="">工具栏配置</a>。</p><h2 id="通用方法" tabindex="-1"><a class="header-anchor" href="#通用方法" aria-hidden="true">#</a> 通用方法</h2><h3 id="确定-menu-key" tabindex="-1"><a class="header-anchor" href="#确定-menu-key" aria-hidden="true">#</a> 确定 menu key</h3><p>要配置哪个菜单，首先要知道这个菜单的 key 。执行 <code>editor.getAllMenuKeys()</code> 可获取编辑器所有菜单，从中找到自己想要的菜单 key 即可。</p><h3 id="获取菜单的默认配置" tabindex="-1"><a class="header-anchor" href="#获取菜单的默认配置" aria-hidden="true">#</a> 获取菜单的默认配置</h3><p>找到菜单 key 之后，可以先看看菜单的当前配置，再自行修改。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editor<span class="token punctuation">.</span><span class="token function">getMenuConfig</span><span class="token punctuation">(</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 获取 uploadImage 的当前配置</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="修改配置" tabindex="-1"><a class="header-anchor" href="#修改配置" aria-hidden="true">#</a> 修改配置</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IEditorConfig<span class="token punctuation">,</span> createEditor<span class="token punctuation">,</span> createToolbar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">// 初始化 MENU_CONF 属性</span>

<span class="token comment">// 修改 uploadImage 菜单配置</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    server<span class="token operator">:</span> <span class="token string">&#39;/api/upload-image&#39;</span><span class="token punctuation">,</span>
    fieldName<span class="token operator">:</span> <span class="token string">&#39;custom-field-name&#39;</span>
    <span class="token comment">// 继续写其他配置...</span>
    
    <span class="token comment">//【注意】不需要修改的不用写，wangEditor 会去 merge 当前其他配置</span>
<span class="token punctuation">}</span>

<span class="token comment">// 修改 otherMenuKey 菜单配置</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;otherMenuKey&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 配置</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建编辑器</span>
<span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token function">createEditor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&#39;#editor-container&#39;</span><span class="token punctuation">,</span>
  config<span class="token operator">:</span> editorConfig<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 创建菜单栏</span>
<span class="token keyword">const</span> toolbar <span class="token operator">=</span> <span class="token function">createToolbar</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>请一定在 <code>createEditor</code> 之前完成菜单配置的修改，否则可能无效。</p></div><h2 id="颜色" tabindex="-1"><a class="header-anchor" href="#颜色" aria-hidden="true">#</a> 颜色</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token comment">// 文字颜色</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;color&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    colors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;#000&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#333&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#666&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 背景色</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;bgColor&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    colors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;#000&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#333&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;#666&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="字号" tabindex="-1"><a class="header-anchor" href="#字号" aria-hidden="true">#</a> 字号</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;fontSize&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    fontSizeList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;12px&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;16px&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;24px&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;40px&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="字体" tabindex="-1"><a class="header-anchor" href="#字体" aria-hidden="true">#</a> 字体</h2><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>请注意，某些字体不能商用。具体请自行查找。</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;fontFamily&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    fontFamilyList<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 元素支持两种形式</span>
        <span class="token comment">//   1. 字符串；</span>
        <span class="token comment">//   2. { name: &#39;xxx&#39;, value: &#39;xxx&#39; }</span>

        <span class="token string">&#39;黑体&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;楷体&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&#39;仿宋&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&#39;仿宋&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&#39;Arial&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;Tahoma&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;Verdana&#39;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="行高" tabindex="-1"><a class="header-anchor" href="#行高" aria-hidden="true">#</a> 行高</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;lineHeight&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    lineHeightList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1.5&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2.5&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="表情" tabindex="-1"><a class="header-anchor" href="#表情" aria-hidden="true">#</a> 表情</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;emotion&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    emotions<span class="token operator">:</span> <span class="token string">&#39;😀 😃 😄 😁 😆 😅 😂 🤣 😊 😇 🙂 🙃 😉&#39;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span> <span class="token comment">// 数组</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="链接" tabindex="-1"><a class="header-anchor" href="#链接" aria-hidden="true">#</a> 链接</h2><ul><li><code>checkLink</code> 校验链接</li><li><code>parseLinkUrl</code> 转换链接 url</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 自定义校验链接</span>
<span class="token keyword">function</span> <span class="token function">customCheckLinkFn</span><span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;链接必须以 http/https 开头&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>

    <span class="token comment">// 返回值有三种选择：</span>
    <span class="token comment">// 1. 返回 true ，说明检查通过，编辑器将正常插入链接</span>
    <span class="token comment">// 2. 返回一个字符串，说明检查未通过，编辑器会阻止插入。会 alert 出错误信息（即返回的字符串）</span>
    <span class="token comment">// 3. 返回 undefined（即没有任何返回），说明检查未通过，编辑器会阻止插入。但不会提示任何信息</span>
<span class="token punctuation">}</span>

<span class="token comment">// 自定义转换链接 url</span>
<span class="token keyword">function</span> <span class="token function">customParseLinkUrl</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> url
<span class="token punctuation">}</span>

<span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token comment">// 插入链接</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;insertLink&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    checkLink<span class="token operator">:</span> customCheckLinkFn<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
    parseLinkUrl<span class="token operator">:</span> customParseLinkUrl<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
<span class="token punctuation">}</span>
<span class="token comment">// 更新链接</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;editLink&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    checkLink<span class="token operator">:</span> customCheckLinkFn<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
    parseLinkUrl<span class="token operator">:</span> customParseLinkUrl<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="图片" tabindex="-1"><a class="header-anchor" href="#图片" aria-hidden="true">#</a> 图片</h2><p>如果用于 Typescript ，需定义图片元素类型。可单独放在 <code>.d.ts</code> 中定义。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> SlateElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">type</span> <span class="token class-name">ImageElement</span> <span class="token operator">=</span> SlateElement <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
    src<span class="token operator">:</span> <span class="token builtin">string</span>
    alt<span class="token operator">:</span> <span class="token builtin">string</span>
    url<span class="token operator">:</span> <span class="token builtin">string</span>
    href<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>图片菜单的配置</p><ul><li><code>onInsertedImage</code> 插入图片之后的回调</li><li><code>onUpdatedImage</code> 更新图片之后的回调</li><li><code>checkImage</code> 校验图片链接</li><li><code>parseImageSrc</code> 转换图片链接</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 自定义校验图片</span>
<span class="token keyword">function</span> <span class="token function">customCheckImageFn</span><span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> alt<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;图片网址必须以 http/https 开头&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>

    <span class="token comment">// 返回值有三种选择：</span>
    <span class="token comment">// 1. 返回 true ，说明检查通过，编辑器将正常插入图片</span>
    <span class="token comment">// 2. 返回一个字符串，说明检查未通过，编辑器会阻止插入。会 alert 出错误信息（即返回的字符串）</span>
    <span class="token comment">// 3. 返回 undefined（即没有任何返回），说明检查未通过，编辑器会阻止插入。但不会提示任何信息</span>
<span class="token punctuation">}</span>

<span class="token comment">// 转换图片链接</span>
<span class="token keyword">function</span> <span class="token function">customParseImageSrc</span><span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> src
<span class="token punctuation">}</span>

<span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token comment">// 插入图片</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;insertImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">onInsertedImage</span><span class="token punctuation">(</span>imageNode<span class="token operator">:</span> ImageElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

        <span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> url<span class="token punctuation">,</span> href <span class="token punctuation">}</span> <span class="token operator">=</span> imageNode
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;inserted image&#39;</span><span class="token punctuation">,</span> src<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> url<span class="token punctuation">,</span> href<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    checkImage<span class="token operator">:</span> customCheckImageFn<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
    parseImageSrc<span class="token operator">:</span> customParseImageSrc<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
<span class="token punctuation">}</span>
<span class="token comment">// 编辑图片</span>
editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;editImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">onUpdatedImage</span><span class="token punctuation">(</span>imageNode<span class="token operator">:</span> ImageElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

        <span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> url <span class="token punctuation">}</span> <span class="token operator">=</span> imageNode
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;updated image&#39;</span><span class="token punctuation">,</span> src<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    checkImage<span class="token operator">:</span> customCheckImageFn<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
    parseImageSrc<span class="token operator">:</span> customParseImageSrc<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="上传图片" tabindex="-1"><a class="header-anchor" href="#上传图片" aria-hidden="true">#</a> 上传图片</h2><p>上传图片的配置比较复杂，拆分为几个部分来讲解。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 上传图片的配置</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="服务端地址" tabindex="-1"><a class="header-anchor" href="#服务端地址" aria-hidden="true">#</a> 服务端地址</h3><p><strong>必填</strong>，否则上传图片会报错。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
     server<span class="token operator">:</span> <span class="token string">&#39;/api/upload&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>【特别注意】服务端 response body 格式要求如下：</strong><br> 上传成功的返回格式：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;errno&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 注意：值是数字，不能是字符串</span>
    <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 图片 src ，必须</span>
        <span class="token string-property property">&quot;alt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 图片描述文字，非必须</span>
        <span class="token string-property property">&quot;href&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zzz&quot;</span> <span class="token comment">// 图片的链接，非必须</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上传失败的返回格式：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;errno&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 只要不等于 0 就行</span>
    <span class="token string-property property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;失败信息&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>如果你的服务端 response body 无法按照上述格式，可以使用下文的 <code>customInsert</code></p></div><h3 id="基本配置" tabindex="-1"><a class="header-anchor" href="#基本配置" aria-hidden="true">#</a> 基本配置</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// form-data fieldName ，默认值 &#39;wangeditor-uploaded-image&#39;</span>
    fieldName<span class="token operator">:</span> <span class="token string">&#39;your-custom-name&#39;</span><span class="token punctuation">,</span>

    <span class="token comment">// 单个文件的最大体积限制，默认为 2M</span>
    maxFileSize<span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 1M</span>

    <span class="token comment">// 最多可上传几个文件，默认为 100</span>
    maxNumberOfFiles<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>

    <span class="token comment">// 选择文件时的类型限制，默认为 [&#39;image/*&#39;] 。如不想限制，则设置为 []</span>
    allowedFileTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;image/*&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 自定义上传参数，例如传递验证的 token 等。参数会被添加到 formData 中，一起上传到服务端。</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        token<span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
        otherKey<span class="token operator">:</span> <span class="token string">&#39;yyy&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 将 meta 拼接到 url 参数中，默认 false</span>
    metaWithUrl<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

    <span class="token comment">// 自定义增加 http  header</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
        Accept<span class="token operator">:</span> <span class="token string">&#39;text/x-json&#39;</span><span class="token punctuation">,</span>
        otherKey<span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 跨域是否传递 cookie ，默认为 false</span>
    withCredentials<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// 超时时间，默认为 10 秒</span>
    timeout<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 5 秒</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="回调函数" tabindex="-1"><a class="header-anchor" href="#回调函数" aria-hidden="true">#</a> 回调函数</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 上传之前触发</span>
    <span class="token function">onBeforeUpload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// file 选中的文件，格式如 { key: file }</span>
        <span class="token keyword">return</span> file

        <span class="token comment">// 可以 return</span>
        <span class="token comment">// 1. return file 或者 new 一个 file ，接下来将上传</span>
        <span class="token comment">// 2. return false ，不上传这个 file</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传进度的回调函数</span>
    <span class="token function">onProgress</span><span class="token punctuation">(</span>progress<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// progress 是 0-100 的数字</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;progress&#39;</span><span class="token punctuation">,</span> progress<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 单个文件上传成功之后</span>
    <span class="token function">onSuccess</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 单个文件上传失败</span>
    <span class="token function">onFailed</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传失败</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传错误，或者触发 timeout 超时</span>
    <span class="token function">onError</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传出错</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="自定义功能" tabindex="-1"><a class="header-anchor" href="#自定义功能" aria-hidden="true">#</a> 自定义功能</h3><p>如果用于 Typescript ，则要定义插入函数的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">InsertFnType</span> <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> alt<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> href<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="自定义插入" tabindex="-1"><a class="header-anchor" href="#自定义插入" aria-hidden="true">#</a> 自定义插入</h4><p>如果你的服务端 response body 无法按照上文规定的格式，则无法插入图片，提示失败。<br> 但你可以使用 <code>customInsert</code> 来自定义插入图片。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义插入图片</span>
    <span class="token function">customInsert</span><span class="token punctuation">(</span>res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// res 即服务端的返回结果</span>

        <span class="token comment">// 从 res 中找到 url alt href ，然后插图图片</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> href<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="自定义上传" tabindex="-1"><a class="header-anchor" href="#自定义上传" aria-hidden="true">#</a> 自定义上传</h4><p>如果你不想使用 wangEditor 自带的上传功能，例如你要上传到阿里云 OSS 。<br> 可以通过 <code>customUpload</code> 来自定义上传。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义上传</span>
    <span class="token keyword">async</span> <span class="token function">customUpload</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// file 即选中的文件</span>
        <span class="token comment">// 自己实现上传，并得到图片 url alt href</span>
        <span class="token comment">// 最后插入图片</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> href<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="自定义选择图片" tabindex="-1"><a class="header-anchor" href="#自定义选择图片" aria-hidden="true">#</a> 自定义选择图片</h4><p>如果你不想使用 wangEditor 自带的选择文件功能，例如你有自己的图床，或者图片选择器。<br> 可以通过 <code>customBrowseAndUpload</code> 来自己实现选择图片、上传图片，并插入图片。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义选择图片</span>
    <span class="token function">customBrowseAndUpload</span><span class="token punctuation">(</span>insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自己选择文件</span>
        <span class="token comment">// 自己上传文件，并得到图片 url alt href</span>
        <span class="token comment">// 最后插入图片</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> href<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="base64-插入图片" tabindex="-1"><a class="header-anchor" href="#base64-插入图片" aria-hidden="true">#</a> base64 插入图片</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 其他配置...</span>

    <span class="token comment">// 小于该值就插入 base64 格式（而不上传），默认为 0</span>
    base64LimitSize<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 5kb</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="获取已删除的图片" tabindex="-1"><a class="header-anchor" href="#获取已删除的图片" aria-hidden="true">#</a> 获取已删除的图片</h3><p>这是一个常见的需求。<br> 上传图片到编辑器，然后又把图片删除了。此时你可能想要拿到这张删除的图片，在服务器也把图片文件删了。</p><ul><li>使用 <a aria-current="page" href="/v5/menu-config.html#%E5%9B%BE%E7%89%87" class="router-link-active router-link-exact-active">onInsertedImage</a> 来收集所有上传或者插入的图片，记录为 <code>imageList1</code></li><li>最后保存编辑器内容之前，使用 <code>editor.getElemsByType(&#39;image&#39;)</code> 获取当前编辑器的所有图片，记录为 <code>imageList2</code></li><li>对比 <code>imageList1</code> 和 <code>imageList2</code> ，两者的差异，就是删除过的图片</li></ul><p>可能会有疑问：为何要在最后去对比？我想要在图片删除时就及时得到反馈。<br> 但，这样是不行的，因为图片删除了，还可能会被<strong>撤销</strong>回来。所以，一定要在最后去操作。</p><h2 id="视频" tabindex="-1"><a class="header-anchor" href="#视频" aria-hidden="true">#</a> 视频</h2><p>如果用于 Typescript ，需定义视频元素类型。可单独放在 <code>.d.ts</code> 中定义。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> SlateElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@wangeditor/editor&#39;</span>

<span class="token keyword">type</span> <span class="token class-name">VideoElement</span> <span class="token operator">=</span> SlateElement <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
    src<span class="token operator">:</span> <span class="token builtin">string</span>
    poster<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>菜单配置</p><ul><li><code>onInsertedVideo</code> 插入视频之后的回调</li><li><code>checkVideo</code> 校验视频链接</li><li><code>parseVideoSrc</code> 转换视频链接</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 自定义校验视频</span>
<span class="token keyword">function</span> <span class="token function">customCheckVideoFn</span><span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;视频地址必须以 http/https 开头&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>

    <span class="token comment">// 返回值有三种选择：</span>
    <span class="token comment">// 1. 返回 true ，说明检查通过，编辑器将正常插入视频</span>
    <span class="token comment">// 2. 返回一个字符串，说明检查未通过，编辑器会阻止插入。会 alert 出错误信息（即返回的字符串）</span>
    <span class="token comment">// 3. 返回 undefined（即没有任何返回），说明检查未通过，编辑器会阻止插入。但不会提示任何信息</span>
<span class="token punctuation">}</span>

<span class="token comment">// 自定义转换视频</span>
<span class="token keyword">function</span> <span class="token function">customParseVideoSrc</span><span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;.bilibili.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 转换 bilibili url 为 iframe （仅作为示例，不保证代码正确和完整）</span>
        <span class="token keyword">const</span> arr <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> vid <span class="token operator">=</span> arr<span class="token punctuation">[</span>arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;iframe src=&quot;//player.bilibili.com/player.html?bvid=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>vid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&gt; &lt;/iframe&gt;</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> src
<span class="token punctuation">}</span>

<span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;insertVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">onInsertedVideo</span><span class="token punctuation">(</span>videoNode<span class="token operator">:</span> VideoElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>videoNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

        <span class="token keyword">const</span> <span class="token punctuation">{</span> src <span class="token punctuation">}</span> <span class="token operator">=</span> videoNode
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;inserted video&#39;</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    checkVideo<span class="token operator">:</span> customCheckVideoFn<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
    parseVideoSrc<span class="token operator">:</span> customParseVideoSrc<span class="token punctuation">,</span> <span class="token comment">// 也支持 async 函数</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="上传视频" tabindex="-1"><a class="header-anchor" href="#上传视频" aria-hidden="true">#</a> 上传视频</h2><p>上传视频的配置比较复杂，拆分为几个部分来讲解。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 上传视频的配置</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="服务端地址-1" tabindex="-1"><a class="header-anchor" href="#服务端地址-1" aria-hidden="true">#</a> 服务端地址</h3><p><strong>必填</strong>，否则上传视频会报错。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
     server<span class="token operator">:</span> <span class="token string">&#39;/api/upload&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>【特别注意】服务端 response body 格式要求如下：</strong><br> 上传成功的返回格式：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;errno&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 注意：值是数字，不能是字符串</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 视频 src ，必须</span>
        <span class="token property">&quot;poster&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx.png&quot;</span> <span class="token comment">// 视频封面图片 url ，可选</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 注意：@wangeditor/editor 版本 &gt;= 5.1.8 才支持 video poster</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上传失败的返回格式：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;errno&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 只要不等于 0 就行</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;失败信息&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>如果你的服务端 response body 无法按照上述格式，可以使用下文的 <code>customInsert</code></p></div><h3 id="基本配置-1" tabindex="-1"><a class="header-anchor" href="#基本配置-1" aria-hidden="true">#</a> 基本配置</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// form-data fieldName ，默认值 &#39;wangeditor-uploaded-video&#39;</span>
    fieldName<span class="token operator">:</span> <span class="token string">&#39;your-custom-name&#39;</span><span class="token punctuation">,</span>

    <span class="token comment">// 单个文件的最大体积限制，默认为 10M</span>
    maxFileSize<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 5M</span>

    <span class="token comment">// 最多可上传几个文件，默认为 5</span>
    maxNumberOfFiles<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>

    <span class="token comment">// 选择文件时的类型限制，默认为 [&#39;video/*&#39;] 。如不想限制，则设置为 []</span>
    allowedFileTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;video/*&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 自定义上传参数，例如传递验证的 token 等。参数会被添加到 formData 中，一起上传到服务端。</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        token<span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">,</span>
        otherKey<span class="token operator">:</span> <span class="token string">&#39;yyy&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 将 meta 拼接到 url 参数中，默认 false</span>
    metaWithUrl<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

    <span class="token comment">// 自定义增加 http  header</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
        Accept<span class="token operator">:</span> <span class="token string">&#39;text/x-json&#39;</span><span class="token punctuation">,</span>
        otherKey<span class="token operator">:</span> <span class="token string">&#39;xxx&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 跨域是否传递 cookie ，默认为 false</span>
    withCredentials<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// 超时时间，默认为 30 秒</span>
    timeout<span class="token operator">:</span> <span class="token number">15</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 15 秒</span>

    <span class="token comment">// 视频不支持 base64 格式插入</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="回调函数-1" tabindex="-1"><a class="header-anchor" href="#回调函数-1" aria-hidden="true">#</a> 回调函数</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 上传之前触发</span>
    <span class="token function">onBeforeUpload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// file 选中的文件，格式如 { key: file }</span>
        <span class="token keyword">return</span> file

        <span class="token comment">// 可以 return</span>
        <span class="token comment">// 1. return file 或者 new 一个 file ，接下来将上传</span>
        <span class="token comment">// 2. return false ，不上传这个 file</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传进度的回调函数</span>
    <span class="token function">onProgress</span><span class="token punctuation">(</span>progress<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// progress 是 0-100 的数字</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;progress&#39;</span><span class="token punctuation">,</span> progress<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 单个文件上传成功之后</span>
    <span class="token function">onSuccess</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 单个文件上传失败</span>
    <span class="token function">onFailed</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传失败</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传错误，或者触发 timeout 超时</span>
    <span class="token function">onError</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 上传出错</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="自定义功能-1" tabindex="-1"><a class="header-anchor" href="#自定义功能-1" aria-hidden="true">#</a> 自定义功能</h3><p>如果用于 Typescript ，则要定义插入函数的类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">InsertFnType</span> <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> poster<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="自定义插入-1" tabindex="-1"><a class="header-anchor" href="#自定义插入-1" aria-hidden="true">#</a> 自定义插入</h4><p>如果你的服务端 response body 无法按照上文规定的格式，则无法插入视频，提示失败。<br> 但你可以使用 <code>customInsert</code> 来自定义插入视频。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义插入视频</span>
    <span class="token function">customInsert</span><span class="token punctuation">(</span>res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// res 即服务端的返回结果</span>

        <span class="token comment">// 从 res 中找到 url poster ，然后插入视频</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> poster<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="自定义上传-1" tabindex="-1"><a class="header-anchor" href="#自定义上传-1" aria-hidden="true">#</a> 自定义上传</h4><p>如果你不想使用 wangEditor 自带的上传功能，例如你要上传到阿里云 OSS 。<br> 可以通过 <code>customUpload</code> 来自定义上传。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义上传</span>
    <span class="token keyword">async</span> <span class="token function">customUpload</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// file 即选中的文件</span>
        <span class="token comment">// 自己实现上传，并得到视频 url poster</span>
        <span class="token comment">// 最后插入视频</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> poster<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="自定义选择视频" tabindex="-1"><a class="header-anchor" href="#自定义选择视频" aria-hidden="true">#</a> 自定义选择视频</h4><p>如果你不想使用 wangEditor 自带的选择文件功能，例如你有自己的图床，或者视频文件选择器。<br> 可以通过 <code>customBrowseAndUpload</code> 来自己实现选择视频、上传视频，并插入视频。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;uploadVideo&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义选择视频</span>
    <span class="token function">customBrowseAndUpload</span><span class="token punctuation">(</span>insertFn<span class="token operator">:</span> InsertFnType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自己选择文件</span>
        <span class="token comment">// 自己上传文件，并得到视频 url poster</span>
        <span class="token comment">// 最后插入视频</span>
        <span class="token function">insertFn</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> poster<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="代码高亮" tabindex="-1"><a class="header-anchor" href="#代码高亮" aria-hidden="true">#</a> 代码高亮</h2><ul><li><code>codeLangs</code> 配置代码语言</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> editorConfig<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>IEditorConfig<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">MENU_CONF</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>

editorConfig<span class="token punctuation">.</span><span class="token constant">MENU_CONF</span><span class="token punctuation">[</span><span class="token string">&#39;codeSelectLang&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 代码语言</span>
    codeLangs<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;CSS&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&#39;css&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;HTML&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&#39;html&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;XML&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&#39;xml&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 其他</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行 createEditor</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>配置代码语言时，只能从 <code>editor.getMenuConfig(&#39;codeSelectLang&#39;).codeLangs</code> 中选择，不能自己随意增加。 如有其他语言的需要，可以给我们提交 issue ，这需要修改源码。</p></div><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他" aria-hidden="true">#</a> 其他</h2><p>其他菜单的配置，请参考上文的 <a href="#%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95">通用方法</a> 自行修改。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: wangfupeng1988@163.com">王福朋</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/v5/editor-config.html" class="" aria-label="编辑器配置"><!--[--><!--]--> 编辑器配置 <!--[--><!--]--></a></span><span class="next"><a href="/v5/API.html" class="" aria-label="编辑器 API"><!--[--><!--]--> 编辑器 API <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.a87fb4fe.js" defer></script>
  </body>
</html>
